(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{13:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(8),i=n.n(r),o=(n(13),n(3)),s=n.n(o),u=n(4),l=n(2),d=c.a.createContext(),p=n(5),b=n(6),f=function(e,t){return fetch(e,t).then((function(e){return e.ok?e.json():Promise.reject("Failed with status:( ".concat(e.status," ").concat(e.statusText,")"))})).catch((function(e){return console.log(e)}))},j=new(function(){function e(t){var n=t.groupId,a=t.apiKey,c=t.baseUrl;Object(p.a)(this,e),this.groupId=n,this.apiKey=a,this.baseUrl=c}return Object(b.a)(e,[{key:"getInitialCards",value:function(){return f("".concat(this.baseUrl).concat(this.groupId,"/cards"),{headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"}})}},{key:"postNewCard",value:function(e){return f("".concat(this.baseUrl).concat(this.groupId,"/cards/"),{method:"POST",headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(e.name),link:"".concat(e.link)})})}},{key:"deleteCardPost",value:function(e){return f("".concat(this.baseUrl).concat(this.groupId,"/cards/").concat(e),{method:"DELETE",headers:{authorization:"".concat(this.apiKey)}})}},{key:"getProfile",value:function(){return f("".concat(this.baseUrl).concat(this.groupId,"/users/me"),{headers:{authorization:"".concat(this.apiKey)}})}},{key:"updateProfile",value:function(e){var t=e.name,n=e.about;return f("".concat(this.baseUrl).concat(this.groupId,"/users/me"),{method:"PATCH",headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t),about:"".concat(n),_id:"".concat(this.apiKey),cohort:"".concat(this.groupId)})})}},{key:"updateProfilePhoto",value:function(e){return f("".concat(this.baseUrl).concat(this.groupId,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"},body:JSON.stringify({avatar:"".concat(e)})})}},{key:"likePhoto",value:function(e){return f("".concat(this.baseUrl).concat(this.groupId,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:"".concat(this.apiKey)}})}},{key:"dislikePhoto",value:function(e){return f("".concat(this.baseUrl).concat(this.groupId,"/cards/likes/").concat(e),{method:"Delete",headers:{authorization:"".concat(this.apiKey)}})}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/",apiKey:"69483cc0-2fd4-4d47-b549-ff7c13f67c88",groupId:"group-12"}),h=n.p+"static/media/Logo_vector.e57222ff.svg",m=n(0),v=function(){return Object(m.jsx)("div",{children:Object(m.jsx)("header",{className:"header",children:Object(m.jsx)("img",{className:"header__logo",src:h,alt:"site's logo"})})})},_=function(e){var t=e.cardData,n=e.onClick,c=e.onCardLike,r=e.onCardDelete,i=Object(a.useContext)(d),o=Object(a.createRef)(),s=t.name,u=t.likes,p=t.link,b=t._id,f=u.some((function(e){return e._id===i._id})),j=Object(a.useState)(!1),h=Object(l.a)(j,2),v=h[0],_=h[1];Object(a.useEffect)((function(){_(o.current.clientWidth<o.current.scrollWidth)}),[o]);return Object(m.jsx)("div",{children:Object(m.jsxs)("div",{className:"card",children:[t.owner._id===i._id&&Object(m.jsx)("button",{className:"button button_type_delete",type:"click",onClick:function(){return r(t)}}),Object(m.jsx)("img",{alt:s,src:p,className:"card__image",onClick:function(){return n(t)}}),Object(m.jsxs)("div",{className:"card__footer",children:[Object(m.jsx)("h2",{ref:o,className:"card__text",children:s}),Object(m.jsxs)("div",{className:"card__likes-container",children:[Object(m.jsx)("button",{className:"button card__like-button ".concat(f&&"card__like-button_active"),id:"likebtn","aria-label":"heart icon (like)",onClick:function(){return c(b,f)}}),Object(m.jsx)("label",{className:"card__like-label",style:{visibility:u.length?"visible":"hidden"},children:u.length})]}),v&&Object(m.jsx)("div",{className:"card__overflow-tooltip",children:s})]})]})})},O=n.p+"static/media/avatar_photo.15862bec.png",x=function(e){var t=e.userInfo,n=e.onEditProfileClick,a=e.onAddPlaceClick,c=e.onEditAvatarClick,r=e.onEnlargeAvatarClick,i=e.onCardClick,o=e.handleCardLike,s=e.cardsData,u=e.onDeleteClick;return Object(m.jsx)("div",{children:Object(m.jsxs)("main",{children:[Object(m.jsxs)("section",{className:"profile",children:[Object(m.jsxs)("div",{className:"profile__photo-container",children:[Object(m.jsx)("img",{className:"profile__photo",src:t?t.avatar:O,alt:t?"Photo of ".concat(t.name):"Photo of Kristine Weiss"}),Object(m.jsxs)("div",{className:"profile__photo-buttons",children:[Object(m.jsx)("button",{className:"button button_type_edit-profile-image",onClick:c}),Object(m.jsx)("button",{className:"button button_type_enlarge-profile-image",onClick:function(){r(t)}})]})]}),Object(m.jsxs)("div",{className:"profile__description",children:[Object(m.jsx)("h1",{className:"profile__name",children:t?t.name:"Kristine Weiss"}),Object(m.jsx)("button",{className:"button profile__button-edit",type:"button","aria-label":"Edit profile",onClick:n}),Object(m.jsx)("p",{className:"profile__about",children:t?t.about:"Travel guide, food enthusiastic and culture lover"})]}),Object(m.jsx)("button",{className:"button profile__button-add",type:"button","aria-label":"Add or create new profile",onClick:a})]}),Object(m.jsx)("section",{className:"locations",children:s.map((function(e){return t=e,Object(m.jsx)(_,{onClick:i,cardData:t,onCardLike:o,onCardDelete:u},t._id);var t}))})]})})},g=function(){return Object(m.jsx)("div",{children:Object(m.jsx)("footer",{className:"footer",children:Object(m.jsx)("p",{className:"footer__about",children:"\xa9 2020 Around The U.S."})})})},C=function(e){var t=e.navigation,n=e.targetObj,a=e.isOpen,c=e.onClose,r=e.id,i=e.useKey,o=e.goLeft,s=e.goRight,u=[Object(m.jsx)("div",{className:"navigation-arrow navigation-arrow_left",onClick:o},"leftNav"),Object(m.jsx)("div",{className:"navigation-arrow navigation-arrow_right",onClick:s},"rightNav")];return i("ArrowRight",s,a),i("ArrowLeft",o,a),i("Escape",c,a),Object(m.jsx)("div",{className:"popup popup_gallery ".concat(a?"popup_active":""),onClick:c,children:Object(m.jsxs)("div",{className:"popup__gallery",id:r,onClick:function(e){e.stopPropagation()},children:[Object(m.jsx)("button",{className:"button button_type_close",type:"button","aria-label":"Close window",onClick:c}),Object(m.jsx)("img",{className:"popup__img",src:n?n.link?n.link:n.avatar?n.avatar:"":null,alt:n?n.name:null}),Object(m.jsx)("h2",{className:"popup__place-name",children:n?n.name:null}),t&&u]})})},k=function(){function e(t){var n=this;Object(p.a)(this,e),this.resetValidation=function(){var e=n._settings.inputStatus;return n._inputList.forEach((function(t){n._deactivateError(t),t.classList.remove("".concat(e))})),n._controlSubmit(!0),n._element},this._deactivateError=function(e){var t=e.nextElementSibling;t.classList.remove(n._settings.inputErrorActive),t.textContent=""},this._activateError=function(e,t){var a=e.nextElementSibling;a.classList.add(n._settings.inputErrorActive),a.textContent=t},this._controlSubmit=function(e){var t=n._settings,a=t.submitSelector,c=t.disabledButton,r=n._formElement.querySelector(".".concat(a));e?(r.classList.add(c),r.setAttribute("disabled",!0)):(r.classList.remove(c),r.removeAttribute("disabled"))},this._checkIfInputValid=function(e){var t=e.target;t.classList.add(n._settings.inputStatus),t.validity.valid?n._deactivateError(t):n._activateError(t,t.validationMessage);var a=n._inputList.some((function(e){return!e.validity.valid}));return n._controlSubmit(a)},this._setEventListeners=function(){var e=n._settings.formInput;return n._inputList=Array.from(n._formElement.querySelectorAll(".".concat(e))),n._formElement.addEventListener("submit",(function(e){e.preventDefault()})),n._formElement.addEventListener("reset",n.resetValidation),n._inputList.forEach((function(e){e.addEventListener("input",n._checkIfInputValid)})),n._element},this._settings={formInput:"form__input",inputStatus:"form__input_status",submitSelector:"button_type_submit",disabledButton:"button_disabled",inputErrorActive:"form__input-error_active"},this._formElement=t}return Object(b.a)(e,[{key:"enableValidation",value:function(){return this._setEventListeners()}}]),e}(),y=function(e){var t=e.children,n=e.formName,c=e.formHeader,r=e.onClose,i=e.id,o=e.isOpen,s=e.onSubmit,u=Object(a.useCallback)((function(e){if(null!==e){var t=new k(e);return t.enableValidation(),t.resetValidation()}}),[o]);return Object(m.jsx)("div",{className:"popup ".concat(o?"popup_active":""),onClick:r,children:Object(m.jsxs)("div",{className:"popup__window",id:i,onClick:function(e){e.stopPropagation()},children:[Object(m.jsx)("button",{className:"button button_type_close",type:"button","aria-label":"Close window",onClick:r}),Object(m.jsx)("h2",{className:"popup__title",children:c}),Object(m.jsxs)("form",{className:"form",ref:u,name:"".concat(n),children:[t,Object(m.jsx)("button",{className:"button button_type_submit",type:"submit",onClick:s,children:"Save"})]})]})})},N=function(e){var t=e.isOpen,n=e.onClose,c=e.updateCurrentUser,r=e.useKey,i=Object(a.useState)(""),o=Object(l.a)(i,2),s=o[0],u=o[1],p=Object(a.useState)(""),b=Object(l.a)(p,2),f=b[0],j=b[1],h=Object(a.useContext)(d);Object(a.useEffect)((function(){u(h.name),j(h.about)}),[h,t]);return r("Escape",n,t),Object(m.jsxs)(y,{isOpen:t,onClose:n,windowId:"w-edit",formHeader:"Edit Profile",formName:"editWindow",onSubmit:function(e){e.preventDefault(),c(Object.assign({},h,{name:s,about:f})),n()},children:[Object(m.jsxs)("label",{htmlFor:"name",className:"form__field",children:[Object(m.jsx)("input",{className:"form__input",type:"text",name:"name",id:"name",value:s||"",placeholder:"Insert name here...",required:!0,minLength:"2",maxLength:"40",onChange:function(e){return u(e.target.value)}}),Object(m.jsx)("span",{className:"form__input-error"})]}),Object(m.jsxs)("label",{htmlFor:"about",className:"form__field",children:[Object(m.jsx)("input",{className:"form__input",type:"text",name:"about",id:"about",value:f||"",placeholder:"Insert job here...",required:!0,minLength:"2",maxLength:"200",onChange:function(e){return j(e.target.value)}}),Object(m.jsx)("span",{className:"form__input-error"})]})]})},w=function(e){var t=e.isOpen,n=e.onClose,c=e.updateCurrentUser,r=e.useKey,i=Object(a.useContext)(d),o=Object(a.useRef)();Object(a.useEffect)((function(){o.current.value=i.avatar}),[i,t]),Object(a.useEffect)((function(){}),[t]);return r("Escape",n,t),Object(m.jsx)(y,{isOpen:t,onClose:n,windowId:"w-editpic",formHeader:"Change profile picture",formName:"editprofpic",onSubmit:function(e){e.preventDefault(),c(Object.assign({},i,{avatar:o.current.value})),n()},children:Object(m.jsxs)("label",{htmlFor:"pictureurl",className:"form__field",children:[Object(m.jsx)("input",{ref:o,className:"form__input",type:"url",name:"avatar",id:"pictureurl",placeholder:"insert url for picture",required:!0}),Object(m.jsx)("span",{className:"form__input-error"})]})})},E=function(e){var t=e.isOpen,n=e.onClose,c=e.addNewCard,r=e.useKey,i=Object(a.useState)(""),o=Object(l.a)(i,2),s=o[0],u=o[1],d=Object(a.useState)(""),p=Object(l.a)(d,2),b=p[0],f=p[1];return r("Escape",n,t),Object(m.jsx)("div",{children:Object(m.jsxs)(y,{isOpen:t,onClose:n,windowId:"w-add",formHeader:"New place",formName:"addWindow",onSubmit:function(e){e.preventDefault(),c({name:s,link:b}),u(""),f(""),n()},children:[Object(m.jsxs)("label",{htmlFor:"place-title",className:"form__field",children:[Object(m.jsx)("input",{className:"form__input",type:"text",name:"name",id:"place-title",placeholder:"Title",value:s,required:!0,minLength:"1",maxLength:"30",onChange:function(e){return u(e.target.value)}}),Object(m.jsx)("span",{className:"form__input-error"})]}),Object(m.jsxs)("label",{htmlFor:"image-link",className:"form__field",children:[Object(m.jsx)("input",{className:"form__input",type:"url",name:"link",id:"image-link",placeholder:"Image link",value:b,required:!0,onChange:function(e){return f(e.target.value)}}),Object(m.jsx)("span",{className:"form__input-error"})]})]})})},S=function(e){var t=e.isOpen,n=e.onClose,a=e.confirmDelete;return Object(m.jsx)("div",{className:"popup ".concat(t?"popup_active":""),onClick:n,children:Object(m.jsxs)("div",{className:"popup__window",id:"w-confirm",onClick:function(e){e.stopPropagation()},children:[Object(m.jsx)("button",{className:"button button_type_close",type:"button","aria-label":"Close window",onClick:n}),Object(m.jsx)("h2",{className:"popup__title",children:"Are you sure?"}),Object(m.jsx)("button",{className:"button button_type_submit",type:"button",onClick:function(){a(),n()},children:"Delete"})]})})};var I=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),i=Object(l.a)(r,2),o=i[0],p=i[1],b=Object(a.useState)(!1),f=Object(l.a)(b,2),h=f[0],_=f[1],O=Object(a.useState)(!1),k=Object(l.a)(O,2),y=k[0],I=k[1],L=Object(a.useState)(!1),P=Object(l.a)(L,2),K=P[0],A=P[1],D=Object(a.useState)(!1),U=Object(l.a)(D,2),T=U[0],F=U[1],z=Object(a.useState)({}),q=Object(l.a)(z,2),R=q[0],V=q[1],H=Object(a.useState)({}),W=Object(l.a)(H,2),J=W[0],B=W[1],M=Object(a.useState)([]),G=Object(l.a)(M,2),Q=G[0],X=G[1];function Y(e,t,n){var c=Object(a.useRef)(t);Object(a.useEffect)((function(){c.current=t})),Object(a.useEffect)((function(){if(n)return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)};function t(t){t.code===e&&c.current(t)}}),[e,n])}var Z=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.getProfile();case 3:(t=e.sent)&&B(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.getInitialCards();case 3:(t=e.sent)&&X(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=13;break}return e.prev=1,e.next=4,j.dislikePhoto(t).then((function(e){return Q.map((function(t){return e._id===t._id?e:t}))}));case 4:a=e.sent,X(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:e.next=23;break;case 13:return e.prev=13,e.next=16,j.likePhoto(t).then((function(e){return Q.map((function(t){return e._id===t._id?e:t}))}));case 16:c=e.sent,X(c),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(13),console.log(e.t1);case 23:case 24:case"end":return e.stop()}}),e,null,[[1,8],[13,20]])})));return function(t,n){return e.apply(this,arguments)}}(),te=function(){var e=Object(u.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=R._id;try{j.deleteCardPost(t).then(X(Q.filter((function(e){return e._id!==t}))))}catch(n){console.log(n)}case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.postNewCard(t);case 3:n=e.sent,X((function(e){return[n].concat(e)})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(){A(!1),I(!1),_(!1),p(!1),c(!1),F(!1)},ce=function(e){j.updateProfile(e).then(B(e))},re=function(){var e=Q.findIndex((function(e){return e===R}));e=parseInt(e-1)>=0?parseInt(e-1):Q.length-1,V(Q[e])},ie=function(){var e=Q.findIndex((function(e){return e===R}));e=parseInt(e+1)<=Q.length-1?parseInt(e+1):0,V(Q[e])};return Object(a.useEffect)((function(){$(),Z()}),[]),Object(m.jsx)("div",{className:"page",children:Object(m.jsx)("div",{className:"page__wrap",children:Object(m.jsxs)(d.Provider,{value:J,children:[Object(m.jsx)(v,{}),Object(m.jsx)(x,{onEditProfileClick:function(){c(!0)},onAddPlaceClick:function(){p(!0)},onEditAvatarClick:function(){_(!0)},onEnlargeAvatarClick:function(e){B(e),I(!0)},onCardClick:function(e){V(e),A(!0)},userInfo:J,setUserData:ce,handleCardLike:ee,onDeleteClick:function(e){V(e),F(!0)},cardsData:Q}),Object(m.jsx)(g,{}),Object(m.jsx)(N,{isOpen:n,onClose:ae,updateCurrentUser:ce,useKey:Y}),Object(m.jsx)(E,{isOpen:o,onClose:ae,addNewCard:ne,useKey:Y}),Object(m.jsx)(w,{isOpen:h,onClose:ae,updateCurrentUser:function(e){j.updateProfilePhoto(e.avatar).then(B(e))},useKey:Y}),Object(m.jsx)(C,{isOpen:K,onClose:ae,id:"w-img",targetObj:R,navigation:!0,useKey:Y,goLeft:re,goRight:ie}),Object(m.jsx)(C,{isOpen:y,onClose:ae,id:"w-piclrg",targetObj:J,navigation:!1,useKey:Y,goLeft:re,goRight:ie}),Object(m.jsx)(S,{isOpen:T,onClose:ae,confirmDelete:te})]})})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(I,{})}),document.getElementById("root")),L()}},[[16,1,2]]]);
//# sourceMappingURL=main.ffb7ed26.chunk.js.map